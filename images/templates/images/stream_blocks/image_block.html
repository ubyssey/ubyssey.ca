{% load wagtailcore_tags %}
{% load wagtailimages_tags %}

{% if self.click_to_enlarge %}

<div class="image-attachment attachment {{ self.style }} {{ self.width }} open-modal" >
    <a href="#">
        {% image self.image original as image %}
        <img class="article-attachment" data-id="{{ image.id }}" data-caption="{{ self.caption }}" data-credit="{{ self.credit }}" data-url="{{ image.url }}" src="{{ image.url }}" alt="{{ self.caption }}" />
    </a>

    <div class="add-to-modal image-modal hide js-dropdown-container">
        <div class="u-container u-container--large modal-contents">
            <div class="image-modal-image" style="background-image: url('{{image.url}}')"></div>
            <a class="close-modal close-gallery focus-on" href="#enlarge"><i class="fa fa-close"></i></a>
        </div>
    </div>

    {% if self.caption or self.credit %}
        <div class="caption">
            {% if self.caption %}{{ self.caption|safe }}{% endif %} <span class="credit">{% if self.credit %}{{ self.credit }}{% endif %}</span>
        </div>
    {% endif %}
</div>

{% else %}

<div class="image-attachment attachment {{ self.style }} {{ self.width }}" >
    {% image self.image original as image %}
    <img class="article-attachment" data-id="{{ image.id }}" data-caption="{{ self.caption }}" data-credit="{{ self.credit }}" data-url="{{ image.url }}" src="{{ image.url }}" alt="{{ self.caption }}" />
    {% if self.caption or self.credit %}
        <div class="caption">
            {% if self.caption %}{{ self.caption|safe }}{% endif %} <span class="credit">{% if self.credit %}{{ self.credit }}{% endif %}</span>
        </div>
    {% endif %}
</div>

{% endif %}