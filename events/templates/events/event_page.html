{% extends 'ubyssey/base.html' %}
{% load static %}
{% load wagtailcore_tags %}
{% load wagtailimages_tags %}
{% load authors_tags %}
{% load humanize %}

{% block stylesheet %}
<link rel="stylesheet" href="{% static 'ubyssey/css/events.css' %}" type="text/css" />
{% endblock %}

{% block head_scripts%}
<link rel="alternate" type="application/atom+xml" title="{{self.title}} - Ubyssey feed" href="/authors/{{self.slug}}/rss">
{% endblock %}

{% block header %}  
{% endblock %}

{% block content %}
<div class="events-slanted-image" style="background-image: linear-gradient(transparent, #0000000a), url('https://visit.ubc.ca/wp-content/uploads/2019/05/chan_2-1940x1216_2x-1024x642.jpg')"></div>
<main class="c-page events-page">
    <div class="events-flex {% if event.selected %}event-view{% endif %}">
        <div id="calendar" class="events-calendar">
            <header class="events">
                <div class="u-container">
                    <div class="logo-area">
                        <a class="home-link" href="{% url 'wagtail_serve' '' %}">
                        <div class="top-logo ubyssey_small_logo light-logo" style="background-image: url('{% static 'ubyssey/images/ubyssey-logo-small.svg' %}')" alt=""></div>
                        <div class="top-logo ubyssey_small_logo dark-logo"  style="background-image: url('{% static 'ubyssey/images/ubyssey-logo 1.svg' %}')" alt=""></div>
                        </a>
                    </div>
                    </div>
                <div class="darkmode-toggle">
                    {% include 'article/objects/darkmode_button.html' with id="topbar" %}
                </div>
                <h1 class="title">Events Around Campus</h1>

                <div class="events-calendar--categories">
                    <ul>
                        <li><a href="?">All</a></li>
                        <li><a href="?category=sports">Sports</a></li>
                        <li><a href="?category=entertainment">Entertainment</a></li>
                        <li><a href="?category=community">Community</a></li>
                        <li><a href="?category=seminar">Seminar</a></li>
                    </ul>
                </div>
            </header>

            <div class="events-calendar--days-of-week">
                <h2 class="day">Mon</h2>
                <h2 class="day">Tue</h2>
                <h2 class="day">Wed</h2>
                <h2 class="day">Thu</h2>
                <h2 class="day">Fri</h2>
                <h2 class="day">Sat</h2>
                <h2 class="day">Sun</h2>
            </div>

            <div class="events-calendar--rows">
            {% for week in calendar %}
                <div class="events-calendar--row">
                    {% if forloop.counter0 == 0%}
                        <h2 class="events-calendar--month">{{week.month}}</h2>
                    {% endif %}
                    {% for day in week.days %}
                        {% if forloop.parentloop.counter0 != 0 and day.day == 1 %}
                            <h2 class="events-calendar--month">{{week.month}}</h2>
                        {% endif %}
                        <div class="day {{day.phase}}">
                            <button onClick="this.parentElement.parentElement.classList.toggle('enlarged')" class="events-calendar--number">
                                {{day.day}}.
                            </button>
                            <ul>
                            {% for event in day.events %} 
                                <li><a title="{{event.title}}" href="?event={{event.event_url}}">
                                    {% if event.start_time|date:"F j" != event.end_time|date:"F j"%}<b>Ongoing</b>{% else %}<b>{{event.start_time|time:"fA"}}</b>{% endif %} {{event.title}}
                                </a></li>
                            {% endfor %}
                            <ul>
                        </div>
                    {% endfor %}
                </div>
            {% endfor %}
            </div>
        </div>
        <div class="events-info-container">
        <div class="events-info">
            <h2 class="event-info--time">
                {% if event.start_time|date:"F j" == event.end_time|date:"F j"%}
                    {{event.start_time|date:"F j"}} {{event.start_time|time:"fA"}} - {{event.end_time|time:"fA"}}
                {% else %}
                    {{event.start_time|date:"F j"}} {{event.start_time|time:"fA"}} - {{event.end_time|date:"F j"}} {{event.end_time|time:"fA"}}
                {% endif %}
            </h2>
            <div class="events-info--content">
                <h2>{{event.title}}</h2>
                <p>{{event.location}}</p>
                <p>{% if event.host %}<b>{{event.host}}:</b>{% endif %} {{event.description|safe}}</p>
                <p><a href="{{event.event_url}}" target="blank">- Found on events.ubc</a></p>
            </div>
        </div>
        </div>
    </div>
</main>
{% endblock %}

{% block scripts %}{% endblock %}

{% block footer %}{% endblock %}